import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o as p,c,a as s,b as a,e as l,f as i}from"./app-2fb9669b.js";const d={},r={href:"https://juejin.cn/post/7242249906257363001",target:"_blank",rel:"noopener noreferrer"};function u(k,n){const e=t("ExternalLinkIcon");return p(),c("div",null,[n[1]||(n[1]=s("h3",{id:"ğŸ’¡-ç›¸å…³é˜…è¯»",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#ğŸ’¡-ç›¸å…³é˜…è¯»","aria-hidden":"true"},"#"),a(" ğŸ’¡ ç›¸å…³é˜…è¯»")],-1)),s("ul",null,[s("li",null,[s("a",r,[n[0]||(n[0]=a("ğŸ‰å¹²è´§æ»¡æ»¡ï¼ŒReactè®¾è®¡åŸç†(äºŒ)ï¼šè—åœ¨æºç é‡Œçš„ä¸¤ä¸ªåœˆï¼Œå…³é”®çš„é“¾è¡¨ç»“æ„å’ŒåŒç¼“å­˜æŠ€æœ¯ğŸ‰")),l(e)])])]),n[2]||(n[2]=i(`<blockquote><p>æ–‡ç« é¦–å‘å…¬ä¼—å·ï¼š èŒèŒå“’è‰å¤´å°†å†›ï¼Œæœ€è¿‘å…³æ³¨æœ‰ğŸï¼Œæ¬¢è¿å…³æ³¨</p></blockquote><p>æœ€è¿‘åœ¨åŠªåŠ›ç ”ç©¶<code>React</code>æºç ï¼Œå‘ç°å®ƒå¹¶æ²¡æœ‰æˆ‘ä¹‹å‰æƒ³è±¡çš„é‚£ä¹ˆéš¾ç†è§£ã€‚</p><p>è™½ç„¶æºç é‡Œé¢æœ‰ä¸€äº›æ¦‚å¿µå°±åƒä¸€åº§äº”æŒ‡å±±å›°ä½äº†æ¡€éªœä¸é©¯çš„å­™æ‚Ÿç©ºã€‚</p><p align="center"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f8fe02980b244d55a369e29b1cb898a7~tplv-k3u1fbpfcp-watermark.image?" alt="1e175ecdaa2843249f0084f011ef2b67.jpeg"></p><p align="center"><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/30cc3568e5a641549c5e5170212f65d2~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" width="50%"></p><p>ä½†å¦‚æœä½ ç†è§£äº†ä¸‹é¢çš„å‡ ä¸ªæ¦‚å¿µï¼Œè¯»æ‡‚reactæºç å°±ä¸æ˜¯éš¾äº‹äº†ã€‚</p><h2 id="ğŸ’-ç¬¬ä¸€åº§å±±-fiberç›¸å…³å˜é‡å‘½å" tabindex="-1"><a class="header-anchor" href="#ğŸ’-ç¬¬ä¸€åº§å±±-fiberç›¸å…³å˜é‡å‘½å" aria-hidden="true">#</a> ğŸ’ ç¬¬ä¸€åº§å±±ï¼š<code>Fiber</code>ç›¸å…³å˜é‡å‘½å</h2><p>æˆ‘ä»¬å·²ç»çŸ¥é“ä»<code>v16.8</code>å¼€å§‹ï¼Œ<code>React</code>è¿›å…¥äº†<code>fiber</code>æ¶æ„æ—¶ä»£ï¼Œå°†ä¸å¯ä¸­æ–­çš„é€’å½’æ”¹è¿›ä¸ºå¯ä¸­æ–­çš„é€’å½’ã€‚</p><p><code>fiber</code>æ¶æ„ä¸»è¦çš„å·¥ä½œæ˜¯åˆ›å»º<code>fiber tree</code>ï¼Œç„¶ååœ¨åˆé€‚çš„æ—¶æœºå°†è¿™æ£µæ ‘æ¸²æŸ“åœ¨å±å¹•ä¸Š.</p><p>æ‰€ä»¥å›´ç»•ç€<code>fiber</code>ï¼Œæºç é‡Œå‡ºç°äº†ä¸€å †å¸¦ç€<code>fiber</code>çš„å˜é‡ã€‚</p><h3 id="ğŸš—-fibernode" tabindex="-1"><a class="header-anchor" href="#ğŸš—-fibernode" aria-hidden="true">#</a> ğŸš— <code>FiberNode</code></h3><p>é¦–å…ˆï¼Œåœ¨æºç ä¸­ï¼Œ<code>FiberNode</code>æ˜¯ä¸ªæ„é€ å‡½æ•°ï¼Œå®ƒåŒ…å«äº†è®¸å¤šå±æ€§ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">FiberNode</span><span class="token punctuation">(</span>
  <span class="token parameter"><span class="token keyword">this</span><span class="token operator">:</span> $FlowFixMe<span class="token punctuation">,</span>
  <span class="token literal-property property">tag</span><span class="token operator">:</span> WorkTag<span class="token punctuation">,</span>
  <span class="token literal-property property">pendingProps</span><span class="token operator">:</span> mixed<span class="token punctuation">,</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token operator">|</span> string<span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> TypeOfMode<span class="token punctuation">,</span></span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Instance</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>tag <span class="token operator">=</span> tag<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>elementType <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>stateNode <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token comment">// Fiber</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>return <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>child <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>sibling <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>ref <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>refCleanup <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>pendingProps <span class="token operator">=</span> pendingProps<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>memoizedProps <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>updateQueue <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>memoizedState <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dependencies <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>mode <span class="token operator">=</span> mode<span class="token punctuation">;</span>

  <span class="token comment">// Effects</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>flags <span class="token operator">=</span> NoFlags<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>subtreeFlags <span class="token operator">=</span> NoFlags<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>deletions <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>lanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>childLanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>alternate <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™äº›å±æ€§å¯ä»¥æ ¹æ®<code>FiberNode</code>çš„ä¸åŒèº«ä»½è¿›è¡Œåˆ’åˆ†ã€‚</p><p><code>FiberNode</code>åœ¨<code>React</code>ä¸­é€šå¸¸æœ‰ä¸‰ç§ä¸åŒçš„èº«ä»½ï¼š</p><ul><li>ğŸ‘‰ ä½œä¸ºæ¶æ„çš„ä¸€ç¯</li></ul><p>ä½œä¸ºæ¶æ„çš„ä¸€ç¯ï¼Œå¤šä¸ª<code>FiberNode</code>ä½œä¸ºåŸºæœ¬èŠ‚ç‚¹æ„æˆ<code>fiber tree</code>ã€‚</p><p>æ­¤æ—¶ï¼Œå®ƒçš„ç›¸å…³å±æ€§å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// Fiber</span>
<span class="token comment">// æŒ‡å‘çˆ¶èŠ‚ç‚¹</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>return <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token comment">// æŒ‡å‘ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>child <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token comment">// æŒ‡å‘å³è¾¹å…„å¼ŸèŠ‚ç‚¹</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>sibling <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ğŸ‘‰ ä½œä¸ºæ•°æ®çš„ä¸€ç¯</li></ul><p>ä½œä¸ºæ•°æ®çš„ä¸€ç¯ï¼Œå®ƒä¿å­˜äº†åŸºæœ¬çš„<code>React</code>å…ƒç´ ä¿¡æ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// Instance</span>
<span class="token comment">// å¯¹åº”ç»„ä»¶çš„ç±»å‹ï¼Œå¯ä»¥æ˜¯classã€functionç­‰</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>tag <span class="token operator">=</span> tag<span class="token punctuation">;</span>
<span class="token comment">// ç»„ä»¶çš„key</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
<span class="token comment">// å’Œtypeç±»ä¼¼çš„å±æ€§</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>elementType <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token comment">// æ ¹æ®tagçš„ä¸åŒï¼Œå¯ä»¥æ˜¯calssã€functionã€tagNameï¼ˆdivã€inputç­‰åŸå§‹çš„æ ‡ç­¾ï¼‰</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token comment">// FiberNodeå¯¹åº”çš„å…ƒç´ </span>
<span class="token keyword">this</span><span class="token punctuation">.</span>stateNode <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œè¯´æ˜ä¸€ä¸‹<code>React</code>å…ƒç´ :</p><p><code>React</code>å…ƒç´ å¯ä»¥æ˜¯<code>&lt;div&gt;Hello!&lt;/div&gt;</code>åŸºæœ¬<code>HTML</code>å…ƒç´ ï¼Œä¹Ÿå¯ä»¥æ˜¯<code>&lt;App /&gt;</code>è¿™æ ·çš„ç»„ä»¶ï¼Œ<code>App</code>æ˜¯ä¸ªç±»ç»„ä»¶æˆ–è€…å‡½æ•°ç»„ä»¶ç­‰ã€‚</p><ul><li>ğŸ‘‰ ä½œä¸ºè°ƒåº¦çš„ä¸€ç¯</li></ul><p>ä½œä¸ºè°ƒåº¦çš„ä¸€ç¯ï¼Œå®ƒæä¾›äº†è°ƒåº¦æ—¶çš„ä¸€äº›ä¾æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// renderç›¸å…³</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>flags <span class="token operator">=</span> NoFlags<span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>subtreeFlags <span class="token operator">=</span> NoFlags<span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>deletions <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token comment">// ä¼˜å…ˆçº§ç›¸å…³</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>lanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>childLanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>
<span class="token comment">// ç¼“å­˜ç›¸å…³</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>alternate <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ğŸš—-fibernode-1" tabindex="-1"><a class="header-anchor" href="#ğŸš—-fibernode-1" aria-hidden="true">#</a> ğŸš— <code>fiberNode</code></h3><p>å‰é¢è¯´è¿‡ï¼Œ<code>FiberNode</code>æ˜¯<code>fiber tree</code>æœ€å°å•å…ƒã€‚è€Œ<code>React</code>å…ƒç´ è¢«ç¼–è¯‘ä¹‹åçš„<code>VNode</code>éƒ½æˆä¸º<code>FiberNode</code>æ„é€ å‡½æ•°çš„å®ä¾‹ï¼Œæºç ä¸­å®ä¾‹éƒ½ç”¨<code>fiber</code>æˆ–è€…<code>workInProgress</code>è¡¨ç¤ºã€‚</p><h3 id="ğŸš—-hostrootfiber" tabindex="-1"><a class="header-anchor" href="#ğŸš—-hostrootfiber" aria-hidden="true">#</a> ğŸš— <code>HostRootFiber</code></h3><p><code>HostRootFiber</code>æ˜¯æºç é‡Œä½¿ç”¨<code>createHostRootFiber</code>åˆ›å»ºçš„<code>Fiber</code>æ ¹èŠ‚ç‚¹ï¼Œå®ƒåŒ…å«æ•´æ£µç»„ä»¶æ ‘çš„ä¿¡æ¯ã€‚å¯¹åº”çš„æ˜¯å¦‚ä¸‹ä»£ç ï¼š</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>React</code>å…è®¸ä½ åˆ›å»ºæœ€å¤šä¸ª<code>HostRootFiber</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ å¯ä»¥æœ‰å¤šä¸ªä¸Šè¿°çš„æŒ‚è½½èŠ‚ç‚¹ã€‚</p><h3 id="ğŸš—-rootfiber" tabindex="-1"><a class="header-anchor" href="#ğŸš—-rootfiber" aria-hidden="true">#</a> ğŸš— <code>rootFiber</code></h3><p>æºç é‡Œé€šè¿‡<code>createHostRootFiber</code>çš„å®ä¾‹åœ¨ä½œä¸ºå‚æ•°æ—¶ï¼Œå¶å°”ä¹Ÿä¼šä½¿ç”¨<code>rootFiber</code>è¡¨ç¤ºã€‚</p><h3 id="ğŸš—-fiberrootnode" tabindex="-1"><a class="header-anchor" href="#ğŸš—-fiberrootnode" aria-hidden="true">#</a> ğŸš— <code>FiberRootNode</code></h3><p><code>FiberRootNode</code>è¡¨ç¤ºåº”ç”¨æ ¹èŠ‚ç‚¹ã€‚å®ƒä¿å­˜ç€åº”ç”¨çš„çŠ¶æ€ä¿¡æ¯å’Œç»„ä»¶ä¿¡æ¯ã€‚å®ƒçš„æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">FiberRootNode</span><span class="token punctuation">(</span>
  <span class="token keyword">this</span><span class="token operator">:</span> $FlowFixMe<span class="token punctuation">,</span>
  <span class="token literal-property property">containerInfo</span><span class="token operator">:</span> any<span class="token punctuation">,</span>
  <span class="token comment">// $FlowFixMe[missing-local-annot]</span>
  tag<span class="token punctuation">,</span>
  <span class="token literal-property property">hydrate</span><span class="token operator">:</span> any<span class="token punctuation">,</span>
  <span class="token literal-property property">identifierPrefix</span><span class="token operator">:</span> any<span class="token punctuation">,</span>
  <span class="token literal-property property">onRecoverableError</span><span class="token operator">:</span> any<span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>tag <span class="token operator">=</span> tag<span class="token punctuation">;</span>
  <span class="token comment">// è¡¨ç¤ºåº”ç”¨ç¨‹åºçš„å®¹å™¨å…ƒç´ ï¼Œå³ç»„ä»¶æ ‘çš„æ ¹èŠ‚ç‚¹</span>
  <span class="token comment">// å®ƒä¸€èˆ¬æ˜¯ä¸€ä¸ª DOM å…ƒç´ ï¼Œç”¨æ¥æ‰¿è½½æ•´ä¸ªç»„ä»¶æ ‘çš„æ¸²æŸ“ç»“æœã€‚</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>containerInfo <span class="token operator">=</span> containerInfo<span class="token punctuation">;</span>
  <span class="token comment">// è¡¨ç¤ºå½“å‰åº”ç”¨ç¨‹åºä¸­å¾…å¤„ç†çš„å­æ ‘åˆ—è¡¨</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>pendingChildren <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token comment">// è¡¨ç¤ºå½“å‰æ¸²æŸ“çš„ Fiber æ ‘çš„æ ¹èŠ‚ç‚¹ï¼ŒæŒ‡å‘ HootRootFiber</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token comment">// ç½‘ç»œè¯·æ±‚ä¼˜åŒ–ç”¨çš„å±æ€§</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>pingCache <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token comment">// è¡¨ç¤ºæœ€è¿‘ä¸€æ¬¡æ¸²æŸ“å®Œæˆçš„ Fiber æ ‘çš„æ ¹èŠ‚ç‚¹</span>
  <span class="token comment">// React åœ¨è¿›è¡Œç»„ä»¶æ›´æ–°æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ Fiber æ ‘</span>
  <span class="token comment">// å¹¶å°†å®ƒä¸æ—§çš„ Fiber æ ‘è¿›è¡Œæ¯”è¾ƒï¼Œæ‰¾å‡ºéœ€è¦æ›´æ–°çš„éƒ¨åˆ†</span>
  <span class="token comment">// ç„¶åè¿›è¡Œæ›´æ–°ã€‚å½“æ›´æ–°å®Œæˆåï¼Œæœ€è¿‘ä¸€æ¬¡æ¸²æŸ“çš„ç»“æœ</span>
  <span class="token comment">// ä¼šå­˜å‚¨åœ¨ \`finishedWork\` å±æ€§ä¸­</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>finishedWork <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token comment">// è¡¨ç¤ºå½“å‰åº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>context <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token comment">// è¡¨ç¤ºå½“å‰åº”ç”¨ç¨‹åºçš„æŒ‚èµ·ä¸Šä¸‹æ–‡</span>
  <span class="token comment">// åœ¨ React ä¸­ï¼Œå½“ç»„ä»¶çš„ä¸Šä¸‹æ–‡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ</span>
  <span class="token comment">// React ä¼šå°†æ–°çš„ä¸Šä¸‹æ–‡ä¿¡æ¯å­˜å‚¨åœ¨ \`pendingContext\` ä¸­</span>
  <span class="token comment">// å¾…ä¸‹ä¸€æ¬¡æ›´æ–°æ—¶å†è¿›è¡Œå¤„ç†ã€‚</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>pendingContext <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token comment">// å½“ç»„ä»¶å®Œæˆæ›´æ–°åçš„å›è°ƒå‡½æ•°</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>callbackNode <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token comment">// è¡¨ç¤ºä¸‹ä¸€æ¬¡æ›´æ–°çš„è¿‡æœŸæ—¶é—´</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>expirationTimes <span class="token operator">=</span> <span class="token function">createLaneMap</span><span class="token punctuation">(</span>NoTimestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// ä¼˜å…ˆçº§ç›¸å…³çš„å±æ€§</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>pendingLanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>suspendedLanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>pingedLanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>expiredLanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>mutableReadLanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>finishedLanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>
  
  <span class="token comment">//....</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šå¸¸çŠ¶å†µä¸‹ï¼Œ<code>FiberRootNode</code>å’Œ<code>HootRootFiber</code>æ˜¯ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚</p><blockquote><p><code>FiberRootNode</code>æ˜¯å•ä¾‹å¯¹è±¡ï¼Œæ¯ä¸ªåº”ç”¨ç¨‹åºåªä¼šæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¦‚æœä¸€ä¸ªé¡µé¢æœ‰å¤šä¸ª<code>React</code>åº”ç”¨ï¼Œé‚£ä¹ˆä¼šæœ‰å¤šä¸ªå®ä¾‹ã€‚</p></blockquote><h3 id="ğŸš—fiberrootnode" tabindex="-1"><a class="header-anchor" href="#ğŸš—fiberrootnode" aria-hidden="true">#</a> ğŸš—<code>fiberRootNode</code></h3><p><code>fiberRootNode</code>æ˜¯<code>createFiberRoot</code>çš„è¿”å›å€¼ç±»å‹ã€‚å³<code>FiberRootNode</code>å®ä¾‹ã€‚æºç é‡Œç”¨<code>fiberRoot</code>è¡¨ç¤ºã€‚</p><h2 id="ğŸ’-æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ’-æ€»ç»“" aria-hidden="true">#</a> ğŸ’ æ€»ç»“</h2><p>åœ¨<code>Fiber</code>æ¶æ„ä¸­ï¼Œ<code>FiberNode</code>å®ä¾‹<code>fiber</code>æ—¢æ˜¯<code>fiber tree</code>çš„åŸºæœ¬æ•°æ®ç»“æ„å•å…ƒï¼Œè®°å½•å…ƒç´ èŠ‚ç‚¹çš„ä¿¡æ¯ï¼Œä¹Ÿæ˜¯ç»„ä»¶æ ¹èŠ‚ç‚¹çš„æ•°æ®å•å…ƒï¼Œè®°å½•æ•´ä¸ªç»„ä»¶æ ‘çš„ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿä¼šä¸ºè°ƒåº¦ç›¸å…³çš„å·¥ä½œæä¾›ä¾æ®ï¼›</p><p><code>FiberRootNode</code>çš„å®ä¾‹<code>fiberRoot</code>æ˜¯åº”ç”¨æ ¹èŠ‚ç‚¹çš„æ•°æ®å•å…ƒï¼ŒåŒ…å«æ•´ä¸ªåº”ç”¨çš„çŠ¶æ€ä¿¡æ¯å’Œç§Ÿä»·ä¿¡æ¯ã€‚å®ƒå’Œ<code>HootRootFiber</code>å®ä¾‹<code>rootFiber</code>æ˜¯ä¸€ä¸€å¯¹åº”å…³ç³»</p>`,45))])}const b=o(d,[["render",u],["__file","ğŸ‰å¹²è´§æ»¡æ»¡ï¼ŒReactè®¾è®¡åŸç†(ä¸€)ï¼šè—åœ¨æºç é‡Œçš„ç´§ç®å’’ğŸ‰.html.vue"]]);export{b as default};
