import{_ as p}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as t,c,a as s,b as a,e as l,f as i}from"./app-06d780e8.js";const u={},r={href:"https://juejin.cn/post/7241567583504728119?share_token=e6d6f76c-3962-473b-bd11-716c41a1089d",target:"_blank",rel:"noopener noreferrer"};function k(d,n){const e=o("ExternalLinkIcon");return t(),c("div",null,[n[1]||(n[1]=s("blockquote",null,[s("p",null,"æ–‡ç« é¦–å‘å…¬ä¼—å·ï¼šèŒèŒå“’è‰å¤´å°†å†›ï¼Œæœ€è¿‘å…³æ³¨æœ‰ğŸï¼Œæ¬¢è¿å…³æ³¨ï¼")],-1)),n[2]||(n[2]=s("p",null,[a("æœ€è¿‘åœ¨ç ”ç©¶"),s("code",null,"React"),a("çš„æºç ï¼Œç„¶åï¼Œæˆ‘å°±æ‚Ÿäº†ï¼")],-1)),n[3]||(n[3]=s("p",{align:"center"},[s("img",{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/42e6ae2e8ca749e58d3c08f7d808b255~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png",width:"50%"})],-1)),n[4]||(n[4]=s("h3",{id:"ğŸ’¡æ¨èé˜…è¯»",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#ğŸ’¡æ¨èé˜…è¯»","aria-hidden":"true"},"#"),a(" ğŸ’¡æ¨èé˜…è¯»")],-1)),s("p",null,[s("a",r,[n[0]||(n[0]=a("ğŸ‰å¹²è´§æ»¡æ»¡ï¼ŒReactè®¾è®¡åŸç†ï¼Œè—åœ¨æºç é‡Œçš„äº”æŒ‡å±±ğŸ‰")),l(e)])]),n[5]||(n[5]=i(`<h2 id="ğŸ’-å¼€é—¨è§å±±" tabindex="-1"><a class="header-anchor" href="#ğŸ’-å¼€é—¨è§å±±" aria-hidden="true">#</a> ğŸ’ å¼€é—¨è§å±±</h2><p>è¯·çœ‹ğŸ‘‡çš„ä»£ç ï¼šä½ è§‰å¾—å¯ä»¥æŒ‰é¢„æœŸè¿è¡Œå—ï¼Ÿ</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useMemo<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> onClick <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  
  <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;App&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>onClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>
          count is <span class="token punctuation">{</span>count<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç­”æ¡ˆæ˜¯å®Œå…¨å¯ä»¥ï¼</p><h2 id="ğŸ’-åˆ†æ" tabindex="-1"><a class="header-anchor" href="#ğŸ’-åˆ†æ" aria-hidden="true">#</a> ğŸ’ åˆ†æ</h2><h3 id="ğŸš—-ç”¨æ³•åˆ†æ" tabindex="-1"><a class="header-anchor" href="#ğŸš—-ç”¨æ³•åˆ†æ" aria-hidden="true">#</a> ğŸš— ç”¨æ³•åˆ†æ</h3><p>ä»–ä»¬éƒ½æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œ<code>useXxx(callback, [...deps])</code></p><ul><li><p>ğŸ‘‰ç¬¬ä¸€ä¸ªå‚æ•°<code>callback</code>æ˜¯å›è°ƒå‡½æ•°</p></li><li><p>ğŸ‘‰ç¬¬äºŒä¸ªå‚æ•°<code>deps</code>æ˜¯ä¾èµ–é¡¹</p></li></ul><p>ä¸åŒçš„æ˜¯å½“ä¾èµ–é¡¹å‘ç”Ÿæ”¹å˜æ—¶</p><ul><li><p>ğŸš†<code>useCallback</code>ä¼šé‡æ–°åˆ›å»ºå›è°ƒå‡½æ•°ï¼Œä»¥ä¿è¯æ¯æ¬¡è°ƒç”¨éƒ½æ˜¯æœ€æ–°å€¼ã€‚å¹¶ç¼“å­˜è¿™ä¸ªå‡½æ•°</p></li><li><p>ğŸš†<code>useEffect</code>å›è°ƒå‡½æ•°ä¼šé‡æ–°æ‰§è¡Œ</p></li><li><p>ğŸš†<code>useMemo</code>å›è°ƒå‡½æ•°ä¼šé‡æ–°æ‰§è¡Œï¼Œå¹¶ç¼“å­˜è¿”å›å€¼ã€‚</p></li></ul><p>æ ¹æ®<code>useMemo</code>è¿”å›å€¼çš„ä¸åŒï¼Œå¯ä»¥æ¨¡æ‹Ÿå‡ºä¸åŒçš„æ•ˆæœï¼š</p><ul><li><p>ğŸ‘‰å½“è¿”å›å€¼æ˜¯ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒ<code>useCallback</code>å’Œæ˜¯å®Œå…¨ç­‰æ•ˆçš„ã€‚</p></li><li><p>ğŸ‘‰å½“æ²¡æœ‰è¿”å›å€¼æˆ–è€…ä¸ç®¡è¿”å›å€¼æ—¶ï¼Œå®ƒ<code>useEffect</code>å’Œéƒ¨åˆ†åŠŸèƒ½æ˜¯ç­‰æ•ˆçš„</p></li></ul><blockquote><p>è¿™æ˜¯å› ä¸ºï¼Œå®ƒä¸ä¼šåƒ<code>useEffect</code>ä¸€æ ·ï¼Œå¯¹è¿”å›å€¼åšå¤„ç†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ— æ³•æ¨¡æ‹Ÿ<code>unMounted</code>ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚</p></blockquote><p>å°±æ˜¯è¿™ä¹ˆç®€å•çš„åŸå› ï¼Œä¸Šé¢çš„ä»£ç ä¼šæ‰§è¡ŒæˆåŠŸã€‚</p><h3 id="ğŸš—-æºç åˆ†æ" tabindex="-1"><a class="header-anchor" href="#ğŸš—-æºç åˆ†æ" aria-hidden="true">#</a> ğŸš— æºç åˆ†æ</h3><p>è¿™éƒ¨åˆ†æ˜¯é€‰è¯»ï¼Œå¦‚æœä½ å¯¹æºç æ„Ÿå…´è¶£ï¼Œå¯ä»¥é˜…è¯»è¿™å—ã€‚</p><h4 id="ğŸš†-usememoæºç é€»è¾‘" tabindex="-1"><a class="header-anchor" href="#ğŸš†-usememoæºç é€»è¾‘" aria-hidden="true">#</a> ğŸš† <code>useMemo</code>æºç é€»è¾‘</h4><ul><li><p>ğŸ‘‰æ³¨å†Œ<code>hook</code>çŠ¶æ€</p></li><li><p>ğŸ‘‰æ­¤æ—¶æ˜¯<code>mounted</code>é˜¶æ®µï¼Œè°ƒç”¨<code>mountMemo</code>ï¼Œ</p></li><li><p>ğŸ‘‰å°†æ³¨å†Œçš„<code>callback</code>å’Œ<code>deps</code>æ‹¿å‡ºæ¥</p></li><li><p>ğŸ‘‰æ‰§è¡Œ<code>callback</code>ï¼Œå¹¶å°†æ‰§è¡Œç»“æœå’Œ<code>deps</code>ç¼“å­˜åœ¨å½“å‰<code>hook</code>çš„çŠ¶æ€ä¸Š</p></li><li><p>ğŸ‘‰<code>deps</code>å‘ç”Ÿæ”¹å˜ï¼Œè¿›å…¥<code>update</code>é˜¶æ®µï¼Œè°ƒç”¨<code>updateMemo</code></p></li><li><p>ğŸ‘‰å–å‡ºå½“å‰çš„<code>hook</code>çŠ¶æ€ï¼Œæ‹¿åˆ°<code>callback</code>å’Œ<code>deps</code>ï¼Œå†ä»å½“å‰<code>hook</code>æ‹¿åˆ°ä¸Šæ¬¡çš„<code>deps</code></p></li><li><p>ğŸ‘‰æ¯”è¾ƒå‰åä¸¤æ¬¡çš„<code>deps</code>ï¼Œå¦‚æœä¸€è‡´ï¼Œç›´æ¥è¿”å›å½“å‰çš„çŠ¶æ€å€¼</p></li><li><p>ğŸ‘‰å¦åˆ™é‡æ–°æ‰§è¡Œ<code>callback</code>ï¼Œä¿æŒè¿”å›å€¼ï¼Œå¹¶å°†è¯¥å€¼æœ€ä¸ºæœ€æ–°çš„çŠ¶æ€å€¼å’Œ<code>deps</code>ä¸€èµ·ä¿å­˜èµ·æ¥</p></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> mountMemo<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
  <span class="token function-variable function">nextCreate</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">T</span><span class="token punctuation">,</span>
  <span class="token literal-property property">deps</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>mixed<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">void</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
  <span class="token comment">// æ‹¿åˆ°å½“å‰çš„hookçŠ¶æ€</span>
  <span class="token keyword">const</span> hook <span class="token operator">=</span> <span class="token function">mountWorkInProgressHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// æ‹¿åˆ°å½“å‰çš„hookä¾èµ–é¡¹</span>
  <span class="token keyword">const</span> nextDeps <span class="token operator">=</span> deps <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> deps<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>shouldDoubleInvokeUserFnsInHooksDEV<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">nextCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// æ‰§è¡Œå›è°ƒå‡½æ•°</span>
  <span class="token keyword">const</span> nextValue <span class="token operator">=</span> <span class="token function">nextCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ç¼“å­˜å›è°ƒå‡½æ•°è¿”å›å€¼å’Œä¾èµ–</span>
  hook<span class="token punctuation">.</span>memoizedState <span class="token operator">=</span> <span class="token punctuation">[</span>nextValue<span class="token punctuation">,</span> nextDeps<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// è¿”å›è¿”å›å€¼</span>
  <span class="token keyword">return</span> nextValue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> updateMemo<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
  <span class="token function-variable function">nextCreate</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">T</span><span class="token punctuation">,</span>
  <span class="token literal-property property">deps</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>mixed<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">void</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> hook <span class="token operator">=</span> <span class="token function">updateWorkInProgressHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> nextDeps <span class="token operator">=</span> deps <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> deps<span class="token punctuation">;</span>
  <span class="token keyword">const</span> prevState <span class="token operator">=</span> hook<span class="token punctuation">.</span>memoizedState<span class="token punctuation">;</span>
  <span class="token comment">// Assume these are defined. If they&#39;re not, areHookInputsEqual will warn.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>nextDeps <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token literal-property property">prevDeps</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>mixed<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> prevState<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">areHookInputsEqual</span><span class="token punctuation">(</span>nextDeps<span class="token punctuation">,</span> prevDeps<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœå‰åä¾èµ–ç›¸åŒæ—¶ï¼Œç›´æ¥è¿”å›å½“å‰å€¼</span>
      <span class="token keyword">return</span> prevState<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>shouldDoubleInvokeUserFnsInHooksDEV<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">nextCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å¦åˆ™é‡æ–°è®¡ç®—èµ‹å€¼ï¼Œå¹¶è¿”å›æœ€æ–°å€¼</span>
  <span class="token keyword">const</span> nextValue <span class="token operator">=</span> <span class="token function">nextCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  hook<span class="token punctuation">.</span>memoizedState <span class="token operator">=</span> <span class="token punctuation">[</span>nextValue<span class="token punctuation">,</span> nextDeps<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> nextValue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ğŸš†-usecallbackæºç é€»è¾‘" tabindex="-1"><a class="header-anchor" href="#ğŸš†-usecallbackæºç é€»è¾‘" aria-hidden="true">#</a> ğŸš† <code>useCallback</code>æºç é€»è¾‘</h4><ul><li><p>ğŸ‘‰æ³¨å†Œ<code>hook</code>çŠ¶æ€</p></li><li><p>ğŸ‘‰æ­¤æ—¶æ˜¯<code>mounted</code>é˜¶æ®µï¼Œè°ƒç”¨<code>mountCallback</code>ï¼Œ</p></li><li><p>ğŸ‘‰å°†æ³¨å†Œçš„<code>callback</code>å’Œ<code>deps</code>æ‹¿å‡ºæ¥</p></li><li><p>ğŸ‘‰å°†<code>callback</code>å’Œ<code>deps</code>ç¼“å­˜åœ¨å½“å‰<code>hook</code>çš„çŠ¶æ€ä¸Š</p></li><li><p>ğŸ‘‰<code>deps</code>å‘ç”Ÿæ”¹å˜ï¼Œè¿›å…¥<code>update</code>é˜¶æ®µï¼Œè°ƒç”¨<code>updateCallback</code></p></li><li><p>ğŸ‘‰å–å‡ºå½“å‰çš„<code>hook</code>çŠ¶æ€ï¼Œæ‹¿åˆ°<code>callback</code>å’Œ<code>deps</code>ï¼Œå†ä»å½“å‰<code>hook</code>æ‹¿åˆ°ä¸Šæ¬¡çš„<code>deps</code></p></li><li><p>ğŸ‘‰æ¯”è¾ƒå‰åä¸¤æ¬¡çš„<code>deps</code>ï¼Œå¦‚æœä¸€è‡´ï¼Œç›´æ¥è¿”å›å½“å‰çš„çŠ¶æ€å€¼</p></li><li><p>ğŸ‘‰å¦åˆ™é‡æ–°å°†<code>callback</code>åšä¸ºæœ€æ–°çš„çŠ¶æ€å€¼å’Œ<code>deps</code>ä¸€èµ·ä¿å­˜èµ·æ¥</p></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> mountCallback<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
  <span class="token literal-property property">callback</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span>
  <span class="token literal-property property">deps</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>mixed<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">void</span> <span class="token operator">|</span> <span class="token keyword">null</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
  <span class="token comment">// è·å–å½“å‰hookçŠ¶æ€</span>
  <span class="token keyword">const</span> hook <span class="token operator">=</span> <span class="token function">mountWorkInProgressHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// è·å–å½“å‰hookä¾èµ–é¡¹</span>
  <span class="token keyword">const</span> nextDeps <span class="token operator">=</span> deps <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> deps<span class="token punctuation">;</span>
  <span class="token comment">// ç¼“å­˜å›è°ƒå‡½æ•°å’Œä¾èµ–</span>
  hook<span class="token punctuation">.</span>memoizedState <span class="token operator">=</span> <span class="token punctuation">[</span>callback<span class="token punctuation">,</span> nextDeps<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// è¿”å›å›è°ƒå‡½æ•°</span>
  <span class="token keyword">return</span> callback<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> updateCallback<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
  <span class="token literal-property property">callback</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span>
  <span class="token literal-property property">deps</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>mixed<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">void</span> <span class="token operator">|</span> <span class="token keyword">null</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> hook <span class="token operator">=</span> <span class="token function">updateWorkInProgressHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> nextDeps <span class="token operator">=</span> deps <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> deps<span class="token punctuation">;</span>
  <span class="token keyword">const</span> prevState <span class="token operator">=</span> hook<span class="token punctuation">.</span>memoizedState<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>nextDeps <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token literal-property property">prevDeps</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>mixed<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> prevState<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">areHookInputsEqual</span><span class="token punctuation">(</span>nextDeps<span class="token punctuation">,</span> prevDeps<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœä¾èµ–é¡¹ç›¸åŒæ—¶ï¼Œç›´æ¥è¿”å›å½“å‰å€¼</span>
      <span class="token keyword">return</span> prevState<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å¦åˆ™é‡æ–°èµ‹å€¼ï¼Œå¹¶è¿”å›æœ€æ–°å€¼</span>
  hook<span class="token punctuation">.</span>memoizedState <span class="token operator">=</span> <span class="token punctuation">[</span>callback<span class="token punctuation">,</span> nextDeps<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> callback<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»æºç ä¸Šçœ‹ï¼Œ<code>useCallback</code>å’Œ<code>useMemo</code>çš„å®ç°ååˆ†ç±»ä¼¼ï¼Œå”¯ä¸€çš„ä¸åŒä¹‹å¤„æ˜¯ï¼š<code>useMemo</code>åœ¨ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–æ—¶ä¼šç¼“å­˜å›è°ƒå‡½æ•°çš„è¿”å›å€¼ã€‚</p><h2 id="ğŸ’-æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ’-æ€»ç»“" aria-hidden="true">#</a> ğŸ’ æ€»ç»“</h2><p><code>useCallback</code>å’Œ<code>useMemo</code>éƒ½æ˜¯ç¼“å­˜ä¸­é—´çŠ¶æ€ï¼Œ</p><p>ä¸åŒçš„æ˜¯<code>useMemo</code>å¯ä»¥ç¼“å­˜ä»»ä½•ç±»å‹çš„å€¼ï¼Œ<code>useCallback</code>ä»…ä»…ç¼“å­˜å‡½æ•°ã€‚æ‰€ä»¥å¼€å¤´çš„ä¾‹å­å¯ä»¥æŒ‰é¢„æœŸè¿è¡Œã€‚</p><p>å¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å¸Œæœ›å¯ä»¥å¸®ä½ ç†è§£åœ°æ›´æ·±ä¸€ç‚¹ã€‚</p><p>ä¸‹ç¯‡æˆ‘ä»¬ç»§ç»­èŠ<code>hook</code>ã€‚</p>`,28))])}const b=p(u,[["render",k],["__file","useMemoè¿˜å¯ä»¥è¿™æ ·ç”¨ï¼ŸuseCallbackï¼šç³Ÿäº†ï¼Œæˆ‘æˆæ›¿èº«äº†ï¼.html.vue"]]);export{b as default};
